# This file is generated by `ray project create`.

name: ray-example-newsreader

description: "A simple news reader example that uses ray actors to serve requests"
tags: ["ray-example", "flask", "rss", "newsreader"]
documentation: https://ray.readthedocs.io/en/latest/auto_examples/plot_newsreader.html

cluster: .rayproject/cluster.yaml

environment:
  requirements: .rayproject/requirements.txt

commands:
  - name: train
    help: "Train a model for clustering news for the newsreader"
    command: |
      wget -nc {{dataset}} -O dataset.zip
      python train.py --dataset /tmp/dataset.zip
    params:
      - name: dataset
        help: "Dataset with news articles to use for training"
        default: https://s3-us-west-2.amazonaws.com/ray-tutorials/hackernews_articles.zip

  - name: run-backend
    command: python server.py
    config:
      port_forward: 5000

  - name: run-frontend
    command: |
      git clone https://github.com/ray-project/qreader
      cd qreader
      npm install
      npm run dev
    config:
      port_forward: 8080

output_files: [
  # Save the logs from the latest run in snapshots.
  "/tmp/ray/session_latest/logs",
  # Save the clustering model.
  "/tmp/model.pkl",
  # Save timeline data.
  "/tmp/timeline.json"
]
